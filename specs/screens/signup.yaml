# S-02: 회원가입
# Version: 2.0

version: "2.0"

screen:
  id: S-02
  name: 회원가입
  route: /auth/signup
  layout: center-form

data_requirements:
  - resource: users
    needs: [id, email, name, role, profileImageUrl]
    action: create

components:
  - id: oauth_buttons
    type: button_group
    position: main
    function: 소셜 로그인 버튼 (Google, 카카오, 네이버)
    data_source:
      providers: [GOOGLE, KAKAO, NAVER]

  - id: role_selection
    type: radio_group
    position: main
    function: 역할 선택 (개발자/테스터/둘 다)
    data_source:
      options: [DEVELOPER, TESTER, BOTH]

  - id: profile_input
    type: form_group
    position: main
    function: 프로필 입력 (닉네임, 이미지)
    data_source:
      fields: [nickname, profileImageUrl]

  - id: agreement_checkboxes
    type: checkbox_group
    position: main
    function: 약관 동의 (이용약관, 개인정보처리방침, 마케팅 선택)
    data_source:
      required: [terms, privacy]
      optional: [marketing]

  - id: submit_button
    type: button
    position: main
    function: 가입 완료 버튼

events:
  - trigger: OAuth 인증 완료
    action: 서버에 Google ID Token 전송
    result: 신규/기존 사용자 판별 → 역할 선택 화면 표시 (신규) / 대시보드 이동 (기존)

  - trigger: 역할 선택
    action: role 필드 업데이트
    result: 프로필 입력 화면 표시

  - trigger: 프로필 입력 완료
    action: nickname, profileImageUrl 저장
    result: 약관 동의 화면 표시

  - trigger: 약관 동의 완료
    action: user 생성 → user_agreements 생성
    result: 대시보드 이동 (개발자 → /developer, 테스터 → /tester)

tests:
  - name: Google 로그인 성공
    when: Google OAuth 인증 완료
    then: [역할 선택 화면 표시]

  - name: 닉네임 중복 검증
    when: 이미 사용 중인 닉네임 입력
    then: [에러 메시지 "이미 사용 중인 닉네임입니다."]

  - name: 약관 미동의 방지
    when: 필수 약관 미체크 후 완료 버튼 클릭
    then: [버튼 비활성화 또는 에러 메시지]
