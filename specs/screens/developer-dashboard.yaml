# D-01: 개발자 대시보드 (홈)
# Version: 2.0

version: "2.0"

screen:
  id: D-01
  name: 개발자 대시보드
  route: /developer
  layout: dashboard

data_requirements:
  - resource: apps
    needs: [id, appName, iconUrl, status, targetTesters, testStartDate, testEndDate]
    filters: { developerId: ":userId", status: ["RECRUITING", "IN_TESTING"] }
    action: read
  - resource: participations
    needs: [appId, status]
    filters: { appId: ":appId" }
    action: read (참여자 수 집계)
  - resource: feedbacks
    needs: [id, appId, tester, overallRating, comment, createdAt]
    filters: { appId: ":appId", limit: 5 }
    action: read (최근 5개)
  - resource: subscription_plans
    needs: [userId, planType, remainingApps]
    action: read
  - resource: developer_profiles
    needs: [userId, credits]
    action: read

components:
  - id: active_tests_summary
    type: card_grid
    position: main
    function: 진행 중인 테스트 요약 카드 (앱명, D-Day, 참여자 수/목표)
    data_source:
      resource: apps

  - id: recent_feedbacks
    type: list
    position: main
    function: 최근 피드백 미리보기 (5개)
    data_source:
      resource: feedbacks

  - id: subscription_card
    type: card
    position: sidebar
    function: 구독 플랜 & 남은 등록 가능 앱 수
    data_source:
      resource: subscription_plans

  - id: credits_card
    type: stat_card
    position: sidebar
    function: 크레딧 잔액 (상호 테스트용)
    data_source:
      resource: developer_profiles
      field: credits

  - id: new_app_button
    type: button
    position: top-right
    function: "새 앱 등록" 빠른 액션 버튼

events:
  - trigger: 테스트 카드 클릭
    action: 앱 상세 페이지 이동
    result: D-04 화면 진입 (/developer/apps/:id)

  - trigger: "새 앱 등록" 버튼 클릭
    action: 앱 등록 페이지 이동
    result: D-02 화면 진입 (/developer/apps/new)

  - trigger: 피드백 아이템 클릭
    action: 피드백 전체 목록 페이지 이동
    result: D-04 화면 진입 (피드백 탭 활성화)

  - trigger: 크레딧 카드 클릭
    action: 크레딧 충전 페이지 이동
    result: 크레딧 구매 모달 또는 페이지

tests:
  - name: 대시보드 초기 로드
    when: 페이지 접속
    then: [진행 중인 앱 카드 표시, 최근 피드백 5개 표시, 구독 플랜 정보 표시]

  - name: D-Day 계산
    when: 앱 상태 = IN_TESTING
    then: [testEndDate 기준 남은 일수 계산, "D-3" 형식 표시]

  - name: 참여자 수 집계
    when: 앱 카드 렌더링
    then: [participations에서 status=ACTIVE 개수 집계, "15/20" 형식 표시]

  - name: 빈 상태 (진행 중인 테스트 없음)
    when: 진행 중인 앱 = 0
    then: [빈 상태 표시, "새 앱을 등록해보세요" 메시지 + "새 앱 등록" 버튼]
